{"code":"import { defineComponent } from \"vue\";\nexport default defineComponent({\n    data() {\n        return {\n            userInfoStyle: {\n                bottom: '180px',\n                left: '50%',\n                marginLeft: '-65px' // 替换 transform\n            },\n            userId: '',\n            username: '',\n            gender: '',\n            selectedOptions: [],\n            birthday: null,\n            scenarioData: null,\n            background: '',\n            description: '',\n            selectedOptionIndex: null,\n            num: null,\n            jobId: null,\n            baseURL: 'https://eqmaster.azurewebsites.net' // 请替换为您的实际后端地址\n        };\n    },\n    onLoad(option = null) {\n        uni.__log__('log', 'at pages/test/test5.uvue:59', 'Received options:', option);\n        // 接收上一个页面传递的数据\n        this.userId = option.userId || '';\n        this.username = decodeURIComponent(option.username || '');\n        this.gender = option.gender || '';\n        this.jobId = option.jobId || '';\n        if (option.options) {\n            try {\n                this.selectedOptions = UTS.JSON.parse(decodeURIComponent(option.options));\n            }\n            catch (e) {\n                uni.__log__('error', 'at pages/test/test5.uvue:71', 'Error parsing options:', e);\n                this.selectedOptions = [];\n            }\n        }\n        if (option.birthday) {\n            try {\n                this.birthday = UTS.JSON.parse(decodeURIComponent(option.birthday));\n            }\n            catch (e) {\n                uni.__log__('error', 'at pages/test/test5.uvue:80', 'Error parsing birthday:', e);\n                this.birthday = null;\n            }\n        }\n        uni.__log__('log', 'at pages/test/test5.uvue:85', 'Parsed data:', {\n            userId: this.userId,\n            username: this.username,\n            gender: this.gender,\n            selectedOptions: this.selectedOptions,\n            birthday: this.birthday,\n            jobId: this.jobId\n        });\n        // 发送数据到后端\n        this.getScenarioData();\n    },\n    methods: {\n        updateUserInfoPosition(x = null, y = null) {\n            this.userInfoStyle.left = `${x}px`;\n            this.userInfoStyle.bottom = `${y}px`;\n            this.userInfoStyle.marginLeft = '0px'; // 移除居中效果\n        },\n        selectOption(index = null) {\n            this.selectedOptionIndex = index;\n            this.num = index + 1; // 设置 num 为选项的索引 + 1\n            uni.__log__('log', 'at pages/test/test5.uvue:106', 'Selected option:', this.num, this.scenarioData.options[index].text);\n        },\n        navigateToTest1() {\n            const testPageUrl = `/pages/test/test3?jobId=${this.jobId}&userId=${this.userId}&username=${encodeURIComponent(this.username)}&gender=${this.gender}&birthday=${encodeURIComponent(UTS.JSON.stringify(this.birthday))}&options=${encodeURIComponent(UTS.JSON.stringify(this.selectedOptions))}&num=${this.num}`;\n            uni.navigateTo({\n                url: testPageUrl\n            });\n        },\n        nextPage() {\n            if (this.num === null) {\n                uni.showToast({\n                    title: '请选择一个选项',\n                    icon: 'none'\n                });\n                return null;\n            }\n            uni.__log__('log', 'at pages/test/test5.uvue:124', 'Sending data to backend:', {\n                choice: this.num,\n                job_id: this.jobId\n            });\n            uni.request({\n                url: `${this.baseURL}/choose_scenario`,\n                method: 'POST',\n                data: {\n                    choice: this.num,\n                    job_id: this.jobId\n                },\n                success: (response) => {\n                    uni.__log__('log', 'at pages/test/test5.uvue:137', 'Full response:', response);\n                    if (response.statusCode === 200) {\n                        const result = response.data;\n                        uni.__log__('log', 'at pages/test/test5.uvue:141', 'Response data:', result);\n                        let nextPageUrl = null;\n                        if (result.message === \"Final choice made. Processing data in background.\") {\n                            nextPageUrl = `/pages/result/result?jobId=${this.jobId}&userId=${this.userId}&username=${encodeURIComponent(this.username)}&gender=${this.gender}&birthday=${encodeURIComponent(UTS.JSON.stringify(this.birthday))}&options=${encodeURIComponent(UTS.JSON.stringify(this.selectedOptions))}&num=${this.num}`;\n                        }\n                        else {\n                            nextPageUrl = `/pages/test/test3?jobId=${this.jobId}&userId=${this.userId}&username=${encodeURIComponent(this.username)}&gender=${this.gender}&birthday=${encodeURIComponent(UTS.JSON.stringify(this.birthday))}&options=${encodeURIComponent(UTS.JSON.stringify(this.selectedOptions))}&num=${this.num}`;\n                        }\n                        uni.__log__('log', 'at pages/test/test5.uvue:150', 'Navigating to:', nextPageUrl);\n                        uni.navigateTo({\n                            url: nextPageUrl,\n                            fail: (err) => {\n                                uni.__log__('error', 'at pages/test/test5.uvue:155', 'Navigation failed:', err);\n                                uni.showToast({\n                                    title: '页面跳转失败',\n                                    icon: 'none'\n                                });\n                            }\n                        });\n                    }\n                    else {\n                        uni.showToast({\n                            title: `请求失败，状态码：${response.statusCode}`,\n                            icon: 'none'\n                        });\n                    }\n                },\n                fail: (error) => {\n                    uni.__log__('error', 'at pages/test/test5.uvue:170', 'Detailed error:', error);\n                    uni.showToast({\n                        title: `发生错误：${error.errMsg}`,\n                        icon: 'none'\n                    });\n                }\n            });\n        },\n        getScenarioData() {\n            uni.request({\n                url: `${this.baseURL}/get_current_scenario`,\n                method: 'POST',\n                success: (res) => {\n                    uni.__log__('log', 'at pages/test/test5.uvue:183', 'Scenario data:', res.data);\n                    // 根据返回的数据结构调整\n                    this.scenarioData = res.data.scenes || res.data;\n                    this.handleScenarioData();\n                },\n                fail: (err) => {\n                    uni.__log__('error', 'at pages/test/test5.uvue:189', 'Error getting scenario data:', err);\n                }\n            });\n        },\n        handleScenarioData() {\n            if (this.scenarioData) {\n                this.description = this.scenarioData.description || '无法获取背景信息';\n            }\n            else {\n                uni.__log__('warn', 'at pages/test/test5.uvue:197', 'Background information not found in scenario data');\n                this.description = '无法获取背景信息';\n            }\n        }\n    }\n});\n//# sourceMappingURL=/Users/wengcekai/Downloads/EQMaster_ios/test2/pages/test/test5.uvue?vue&type=script&lang.uts.js.map","references":[],"uniExtApis":["uni.__log__","uni.navigateTo","uni.showToast","uni.request"],"map":"{\"version\":3,\"file\":\"test5.uvue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"test5.uvue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\";AACA,+BAAe;IACb,IAAI;QACF,OAAO;YACL,aAAa,EAAE;gBACb,MAAM,EAAE,OAAO;gBACf,IAAI,EAAE,KAAK;gBACX,UAAU,EAAE,OAAO,CAAC,eAAe;aACpC;YACD,MAAM,EAAE,EAAE;YACV,QAAQ,EAAE,EAAE;YACZ,MAAM,EAAE,EAAE;YACV,eAAe,EAAE,EAAE;YACnB,QAAQ,EAAE,IAAI;YACd,YAAY,EAAE,IAAI;YAClB,UAAU,EAAE,EAAE;YACd,WAAW,EAAE,EAAE;YACf,mBAAmB,EAAE,IAAI;YACzB,GAAG,EAAE,IAAI;YACT,KAAK,EAAE,IAAI;YACX,OAAO,EAAE,oCAAoC,CAAC,eAAe;SAC9D,CAAA;IACH,CAAC;IACD,MAAM,CAAC,aAAM;QACX,GAAG,CAAC,OAAO,CAAC,KAAK,EAAC,6BAA6B,EAAC,mBAAmB,EAAE,MAAM,CAAC,CAAC;QAE7E,eAAe;QACf,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,IAAI,EAAE,CAAC;QAClC,IAAI,CAAC,QAAQ,GAAG,kBAAkB,CAAC,MAAM,CAAC,QAAQ,IAAI,EAAE,CAAC,CAAC;QAC1D,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,IAAI,EAAE,CAAC;QAClC,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC,KAAK,IAAI,EAAE,CAAC;QAEhC,IAAI,MAAM,CAAC,OAAO,EAAE;YAClB,IAAI;gBACF,IAAI,CAAC,eAAe,GAAG,SAAK,KAAK,CAAC,kBAAkB,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC;aACvE;YAAC,OAAO,CAAC,EAAE;gBACV,GAAG,CAAC,OAAO,CAAC,OAAO,EAAC,6BAA6B,EAAC,wBAAwB,EAAE,CAAC,CAAC,CAAC;gBAC/E,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;aAC3B;SACF;QAED,IAAI,MAAM,CAAC,QAAQ,EAAE;YACnB,IAAI;gBACF,IAAI,CAAC,QAAQ,GAAG,SAAK,KAAK,CAAC,kBAAkB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC;aACjE;YAAC,OAAO,CAAC,EAAE;gBACV,GAAG,CAAC,OAAO,CAAC,OAAO,EAAC,6BAA6B,EAAC,yBAAyB,EAAE,CAAC,CAAC,CAAC;gBAChF,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;aACtB;SACF;QAED,GAAG,CAAC,OAAO,CAAC,KAAK,EAAC,6BAA6B,EAAC,cAAc,EAAE;YAC9D,MAAM,EAAE,IAAI,CAAC,MAAM;YACnB,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,MAAM,EAAE,IAAI,CAAC,MAAM;YACnB,eAAe,EAAE,IAAI,CAAC,eAAe;YACrC,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,KAAK,EAAE,IAAI,CAAC,KAAK;SAClB,CAAC,CAAC;QAEH,UAAU;QACV,IAAI,CAAC,eAAe,EAAE,CAAC;IACzB,CAAC;IACD,OAAO,EAAE;QACP,sBAAsB,CAAC,CAAC,OAAA,EAAE,CAAC,OAAA;YACzB,IAAI,CAAC,aAAa,CAAC,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC;YACnC,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,GAAG,CAAC,IAAI,CAAC;YACrC,IAAI,CAAC,aAAa,CAAC,UAAU,GAAG,KAAK,CAAC,CAAC,SAAS;QAClD,CAAC;QACD,YAAY,CAAC,KAAK,OAAA;YAChB,IAAI,CAAC,mBAAmB,GAAG,KAAK,CAAC;YACjC,IAAI,CAAC,GAAG,GAAG,KAAK,GAAG,CAAC,CAAC,CAAC,oBAAoB;YAC1C,GAAG,CAAC,OAAO,CAAC,KAAK,EAAC,8BAA8B,EAAC,kBAAkB,EAAE,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC;QACxH,CAAC;QACD,eAAe;YACb,MAAM,WAAW,GAAG,2BAA2B,IAAI,CAAC,KAAK,WAAW,IAAI,CAAC,MAAM,aAAa,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,IAAI,CAAC,MAAM,aAAa,kBAAkB,CAAC,SAAK,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,YAAY,kBAAkB,CAAC,SAAK,SAAS,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,QAAQ,IAAI,CAAC,GAAG,EAAE,CAAC;YAExS,GAAG,CAAC,UAAU,CAAC;gBACb,GAAG,EAAE,WAAW;aACjB,CAAC,CAAC;QACL,CAAC;QACD,QAAQ;YACN,IAAI,IAAI,CAAC,GAAG,KAAK,IAAI,EAAE;gBACrB,GAAG,CAAC,SAAS,CAAC;oBACZ,KAAK,EAAE,SAAS;oBAChB,IAAI,EAAE,MAAM;iBACb,CAAC,CAAC;gBACH,YAAO;aACR;YAED,GAAG,CAAC,OAAO,CAAC,KAAK,EAAC,8BAA8B,EAAC,0BAA0B,EAAE;gBAC3E,MAAM,EAAE,IAAI,CAAC,GAAG;gBAChB,MAAM,EAAE,IAAI,CAAC,KAAK;aACnB,CAAC,CAAC;YAEH,GAAG,CAAC,OAAO,CAAC;gBACV,GAAG,EAAE,GAAG,IAAI,CAAC,OAAO,kBAAkB;gBACtC,MAAM,EAAE,MAAM;gBACd,IAAI,EAAE;oBACJ,MAAM,EAAE,IAAI,CAAC,GAAG;oBAChB,MAAM,EAAE,IAAI,CAAC,KAAK;iBACnB;gBACD,OAAO,EAAE,CAAC,QAAQ;oBAChB,GAAG,CAAC,OAAO,CAAC,KAAK,EAAC,8BAA8B,EAAC,gBAAgB,EAAE,QAAQ,CAAC,CAAC;oBAE7E,IAAI,QAAQ,CAAC,UAAU,KAAK,GAAG,EAAE;wBAC/B,MAAM,MAAM,GAAG,QAAQ,CAAC,IAAI,CAAC;wBAC7B,GAAG,CAAC,OAAO,CAAC,KAAK,EAAC,8BAA8B,EAAC,gBAAgB,EAAE,MAAM,CAAC,CAAC;wBAE3E,IAAI,WAAW,OAAA,CAAC;wBAChB,IAAI,MAAM,CAAC,OAAO,KAAK,mDAAmD,EAAE;4BAC1E,WAAW,GAAG,8BAA8B,IAAI,CAAC,KAAK,WAAW,IAAI,CAAC,MAAM,aAAa,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,IAAI,CAAC,MAAM,aAAa,kBAAkB,CAAC,SAAK,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,YAAY,kBAAkB,CAAC,SAAK,SAAS,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,QAAQ,IAAI,CAAC,GAAG,EAAE,CAAC;yBACtS;6BAAM;4BACL,WAAW,GAAG,2BAA2B,IAAI,CAAC,KAAK,WAAW,IAAI,CAAC,MAAM,aAAa,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,IAAI,CAAC,MAAM,aAAa,kBAAkB,CAAC,SAAK,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,YAAY,kBAAkB,CAAC,SAAK,SAAS,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,QAAQ,IAAI,CAAC,GAAG,EAAE,CAAC;yBACnS;wBAED,GAAG,CAAC,OAAO,CAAC,KAAK,EAAC,8BAA8B,EAAC,gBAAgB,EAAE,WAAW,CAAC,CAAC;wBAEhF,GAAG,CAAC,UAAU,CAAC;4BACb,GAAG,EAAE,WAAW;4BAChB,IAAI,EAAE,CAAC,GAAG;gCACR,GAAG,CAAC,OAAO,CAAC,OAAO,EAAC,8BAA8B,EAAC,oBAAoB,EAAE,GAAG,CAAC,CAAC;gCAC9E,GAAG,CAAC,SAAS,CAAC;oCACZ,KAAK,EAAE,QAAQ;oCACf,IAAI,EAAE,MAAM;iCACb,CAAC,CAAC;4BACL,CAAC;yBACF,CAAC,CAAC;qBACJ;yBAAM;wBACL,GAAG,CAAC,SAAS,CAAC;4BACZ,KAAK,EAAE,YAAY,QAAQ,CAAC,UAAU,EAAE;4BACxC,IAAI,EAAE,MAAM;yBACb,CAAC,CAAC;qBACJ;gBACH,CAAC;gBACD,IAAI,EAAE,CAAC,KAAK;oBACV,GAAG,CAAC,OAAO,CAAC,OAAO,EAAC,8BAA8B,EAAC,iBAAiB,EAAE,KAAK,CAAC,CAAC;oBAC7E,GAAG,CAAC,SAAS,CAAC;wBACZ,KAAK,EAAE,QAAQ,KAAK,CAAC,MAAM,EAAE;wBAC7B,IAAI,EAAE,MAAM;qBACb,CAAC,CAAC;gBACL,CAAC;aACF,CAAC,CAAC;QACL,CAAC;QACD,eAAe;YACb,GAAG,CAAC,OAAO,CAAC;gBACV,GAAG,EAAE,GAAG,IAAI,CAAC,OAAO,uBAAuB;gBAC3C,MAAM,EAAE,MAAM;gBACd,OAAO,EAAE,CAAC,GAAG;oBACX,GAAG,CAAC,OAAO,CAAC,KAAK,EAAC,8BAA8B,EAAC,gBAAgB,EAAE,GAAG,CAAC,IAAI,CAAC,CAAC;oBAC7E,cAAc;oBACd,IAAI,CAAC,YAAY,GAAG,GAAG,CAAC,IAAI,CAAC,MAAM,IAAI,GAAG,CAAC,IAAI,CAAC;oBAChD,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBAC5B,CAAC;gBACD,IAAI,EAAE,CAAC,GAAG;oBACR,GAAG,CAAC,OAAO,CAAC,OAAO,EAAC,8BAA8B,EAAC,8BAA8B,EAAE,GAAG,CAAC,CAAC;gBAC1F,CAAC;aACF,CAAC,CAAC;QACL,CAAC;QACD,kBAAkB;YAChB,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,IAAI,UAAU,CAAC;aAChE;iBAAM;gBACL,GAAG,CAAC,OAAO,CAAC,MAAM,EAAC,8BAA8B,EAAC,mDAAmD,CAAC,CAAC;gBACvG,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC;aAC/B;QACH,CAAC;KACF;CACF,EAAA\"}"}
