{"code":"import { defineComponent } from \"vue\";\nexport default defineComponent({\n    data() {\n        return {\n            userId: '',\n            username: '',\n            gender: '',\n            selectedOptions: [],\n            birthday: null,\n            scenarioData: null,\n            background: '请点击下方箭头继续',\n            jobId: ''\n        };\n    },\n    onLoad(option = null) {\n        uni.__log__('log', 'at pages/test/test.uvue:49', 'Received options:', option);\n        // 接收上一个页面传递的数据\n        this.userId = option.userId || '';\n        this.username = decodeURIComponent(option.username || '');\n        this.gender = option.gender || '';\n        if (option.options) {\n            try {\n                this.selectedOptions = UTS.JSON.parse(decodeURIComponent(option.options));\n            }\n            catch (e) {\n                uni.__log__('error', 'at pages/test/test.uvue:60', 'Error parsing options:', e);\n                this.selectedOptions = [];\n            }\n        }\n        if (option.birthday) {\n            try {\n                this.birthday = UTS.JSON.parse(decodeURIComponent(option.birthday));\n            }\n            catch (e) {\n                uni.__log__('error', 'at pages/test/test.uvue:69', 'Error parsing birthday:', e);\n                this.birthday = null;\n            }\n        }\n        uni.__log__('log', 'at pages/test/test.uvue:74', 'Parsed data:', {\n            userId: this.userId,\n            username: this.username,\n            gender: this.gender,\n            selectedOptions: this.selectedOptions,\n            birthday: this.birthday\n        });\n        // 发送数据到后端\n        this.sendDataToBackend();\n    },\n    methods: {\n        navigateToTest1() {\n            const testPageUrl = `/pages/test/test1?jobId=${this.jobId}&userId=${this.userId}&username=${encodeURIComponent(this.username)}&gender=${this.gender}&birthday=${encodeURIComponent(UTS.JSON.stringify(this.birthday))}&options=${encodeURIComponent(UTS.JSON.stringify(this.selectedOptions))}`;\n            uni.navigateTo({\n                url: testPageUrl\n            });\n        },\n        sendDataToBackend() {\n            uni.request({\n                url: 'https://eqmaster.azurewebsites.net/create_profile',\n                method: 'POST',\n                data: {\n                    name: this.username,\n                    job_level: this.jobLevel || '',\n                    gender: this.gender,\n                    concerns: this.selectedOptions,\n                },\n                success: (res) => {\n                    uni.__log__('log', 'at pages/test/test.uvue:104', 'Backend response:', res.data);\n                    this.jobId = res.data.job_id; // 存储返回的 job_id\n                    // 获取 job_id 后立即调用 start_scenario\n                    this.getScenarioData();\n                },\n                fail: (err) => {\n                    uni.__log__('error', 'at pages/test/test.uvue:111', 'Error sending data to backend:', err);\n                }\n            });\n        },\n        getScenarioData() {\n            uni.request({\n                url: 'https://eqmaster.azurewebsites.net/start_scenario/${this.jobId}',\n                method: 'POST',\n                success: (res) => {\n                    try {\n                        const data = typeof res.data === 'string' ? UTS.JSON.parse(res.data) : res.data;\n                        uni.__log__('log', 'at pages/test/test.uvue:122', 'Scenario data:', data);\n                        this.scenarioData = data.scenes || null;\n                        this.handleScenarioData();\n                    }\n                    catch (error) {\n                        uni.__log__('error', 'at pages/test/test.uvue:126', 'Error parsing scenario data:', error);\n                        this.background = '获取场景数据时出错。';\n                    }\n                },\n                fail: (err) => {\n                    uni.__log__('error', 'at pages/test/test.uvue:131', 'Error getting scenario data:', err);\n                    this.background = '无法获取场景数据。';\n                }\n            });\n        },\n        handleScenarioData() {\n            if (this.scenarioData) {\n                this.background = this.scenarioData.background || '请点击下方箭头继续';\n            }\n            else {\n                this.background = '请点击下方箭头继续';\n            }\n        }\n    }\n});\n//# sourceMappingURL=/Users/wengcekai/Downloads/EQMaster_ios/test2/pages/test/test.uvue?vue&type=script&lang.uts.js.map","references":[],"uniExtApis":["uni.__log__","uni.navigateTo","uni.request"],"map":"{\"version\":3,\"file\":\"test.uvue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"test.uvue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
